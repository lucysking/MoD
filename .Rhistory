)
)
dis_BFs
glm.4 <- glm.nb(
parent_num_childhood  ~
scale(bces_total_W, scale = FALSE),
data = df
)
check_model(glm.4)
check_heteroscedasticity(glm.4)
model_performance(glm.4)
model_parameters(
glm.4,
exponentiate = TRUE
)
# create new dataset with BCEs only
df_new.1 <-
df %>%
dplyr::select(
bces_total_W
)
# generate predicted values
df_new.1$pred <-
predict(
glm.4,
df_new.1,
type = "response"
)
# plot
bces_plot <-
df_new.1 %>%
ggplot(aes(bces_total_W, pred)) +
geom_smooth(color = "black", size = 3, span = 1) +
geom_jitter2(
data = df,
aes(bces_total_W, parent_num_childhood_W),
size = 5,
alpha = 1/3,
color = "black"
) +
scale_y_continuous(breaks = seq.int(0, 15, 2)) +
scale_x_continuous(breaks = seq.int(0, 10, 1)) +
theme_mod +
labs(
title = "Discriminant validity",
x = "BCEs\n Maternal positive childhood experiences",
y = NULL
)
bces_plot
ggsave(
"~/Box/lucy_king_files/MoD/APCA/figures/bces_num_types.png",
dpi = 500,
height = 5,
width = 4
)
ctq_bces_plots <- arrangeGrob(
ctq_plot,
bces_plot,
nrow = 1
)
ggsave(
"~/Box/lucy_king_files/MoD/APCA/figures/ctq_bces_apca_childhood.png",
ctq_bces_plots,
dpi = 1000,
height = 5,
width = 10
)
SpearmanRho(df$parent_num_types, df$cesd_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$parent_num_childhood_W, df$cesd_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$parent_num_precon, df$cesd_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$preg_num_types_W, df$cesd_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$since_child_num_types_W, df$cesd_total_W, use = "complete.obs", conf.level = .95)
cum_cesd <- correlationBF(df$parent_num_types, df$cesd_total_W)
describe_posterior(cum_cesd, ci = 0.95)$BF
childhood_cesd <- correlationBF(df$parent_num_childhood_W, df$cesd_total_W)
childhood_cesd <- describe_posterior(childhood_cesd, ci = 0.95)$BF
precon_cesd <- correlationBF(df$parent_num_precon, df$cesd_total_W)
precon_cesd <- describe_posterior(precon_cesd, ci = 0.95)$BF
preg_cesd <- correlationBF(df$preg_num_types_W, df$cesd_total_W)
preg_cesd <- describe_posterior(preg_cesd, ci = 0.95)$BF
since_cesd <- correlationBF(df$since_child_num_types_W, df$cesd_total_W)
since_cesd <-describe_posterior(since_cesd, ci = 0.95)$BF
mp_BFs <-
tibble(
key = c(
"parent_num_childhood",
"parent_num_precon",
"preg_num_types",
"since_child_num_types"
),
BF_cesd = c(
childhood_cesd,
precon_cesd,
preg_cesd,
since_cesd
)
)
mp_BFs
lm.1 <- lm(
cesd_total_W ~
parent_num_childhood_W +
parent_num_precon +
preg_num_types_W +
since_child_num_types_W,
data = df
)
check_model(lm.1)
model_performance(lm.1)
model_parameters(lm.1)
model_parameters(lm.1, standardize = "refit")
SpearmanRho(df$parent_num_types, df$bai_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$parent_num_childhood_W, df$bai_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$parent_num_precon, df$bai_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$preg_num_types_W, df$bai_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$since_child_num_types_W, df$bai_total_W, use = "complete.obs", conf.level = .95)
cum_bai <- correlationBF(df$parent_num_types, df$bai_total_W)
describe_posterior(cum_bai, ci = 0.95)$BF
childhood_bai <- correlationBF(df$parent_num_childhood_W, df$bai_total_W)
childhood_bai<- describe_posterior(childhood_bai, ci = 0.95)$BF
precon_bai <- correlationBF(df$parent_num_precon, df$bai_total_W)
precon_bai <- describe_posterior(precon_bai, ci = 0.95)$BF
preg_bai <- correlationBF(df$preg_num_types_W, df$bai_total_W)
preg_bai <- describe_posterior(preg_bai, ci = 0.95)$BF
since_bai <- correlationBF(df$since_child_num_types_W, df$bai_total_W)
since_bai <-describe_posterior(since_bai, ci = 0.95)$BF
mp_BFs <-
mp_BFs %>%
cbind(
BF_bai = c(
childhood_bai,
precon_bai,
preg_bai,
since_bai
)
)
lm.2 <- lm(
bai_total_W ~
parent_num_childhood_W +
parent_num_precon +
preg_num_types_W +
since_child_num_types_W,
data = df
)
check_model(lm.2)
model_performance(lm.2)
model_parameters(lm.2)
model_parameters(lm.2, standardize = "refit")
scales_apca_cesd_bai_x <- list(
"Childhood adversity" = scale_x_continuous(
breaks = seq.int(0, 14, 2)
),
"Preconception adversity" = scale_x_continuous(
breaks = seq.int(0, 10, 2)
),
"Prenatal adversity"= scale_x_continuous(
breaks = seq.int(0, 8, 1)
),
"Adversity since birth" = scale_x_continuous(
breaks = seq.int(0, 12, 2)
)
)
scales_apca_cesd_bai_y <- list(
"Depression" = scale_y_continuous(
breaks = seq.int(0, 30, 5)
),
"Anxiety" = scale_y_continuous(
breaks = seq.int(0, 25, 5)
)
)
mp_BFs_lf <-
mp_BFs %>%
rename(
Depression = BF_cesd,
Anxiety = BF_bai
) %>%
pivot_longer(
cols = -key
) %>%
rename(
adversity_type = key,
symptoms_type = name,
BF = value
)
df %>%
dplyr::select(
Depression = cesd_total_W,
Anxiety = bai_total_W,
parent_num_childhood = parent_num_childhood_W,
parent_num_precon,
preg_num_types = preg_num_types_W,
since_child_num_types = since_child_num_types_W
) %>%
pivot_longer(
cols = parent_num_childhood:since_child_num_types,
names_to = "adversity_type",
values_to = "adversity_score"
) %>%
pivot_longer(
cols = Depression:Anxiety,
names_to = "symptoms_type",
values_to = "symptoms_score"
) %>%
left_join(mp_BFs_lf, by = c("adversity_type", "symptoms_type")) %>%
mutate(
adversity_type = factor(
adversity_type,
levels = c(
"parent_num_childhood",
"parent_num_precon",
"preg_num_types",
"since_child_num_types"
),
labels = c(
"Childhood adversity",
"Preconception adversity",
"Prenatal adversity",
"Adversity since birth"
)
),
BF_logic = case_when(
BF > .33 & BF < 1 ~ "Anecdotal",
BF >= 1 & BF < 3 ~ "Anecdotal",
BF >= 3 & BF < 10 ~ "Moderate",
BF >= 10 & BF < 30 ~ "Strong",
BF >= 30 & BF < 100 ~ "Very strong",
BF >= 100 ~ "Extreme"
),
BF_logic = factor(
BF_logic,
levels = c("Anecdotal", "Moderate", "Strong", "Very strong", "Extreme")
)
) %>%
ggplot(aes(adversity_score, symptoms_score)) +
geom_jitter2(size = 4, alpha = 1/2, color = "black") +
geom_smooth(
method = "lm",
size = 4,
se = FALSE,
aes(color = BF_logic)
) +
scale_y_continuous(breaks = seq.int(0, 40, 5)) +
scale_x_continuous(breaks = seq.int(0, 15, 1)) +
scale_color_manual(
values = c(
"#ffffb2",
"#fed976",
"#feb24c",
"#fd8d3c",
"#f03b20",
"#bd0026"
),
drop = FALSE
) +
theme_grey() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 18, hjust = .5, face = "bold"),
axis.title = element_text(size = 20),
axis.text = element_text(size = 18),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
strip.text.x = element_text(size = 16, face = "bold", color = "black"),
strip.text.y = element_text(size = 20, face = "bold", color = "black"),
strip.background = element_blank(),
legend.position = "right"
) +
labs(
color = "Bayes Factor\n(Strength of evidence)",
x = NULL,
y = "Maternal symptoms"
) +
facet_grid_sc(
symptoms_type ~ adversity_type,
scales = list(x = scales_apca_cesd_bai_x)
)
ggsave(
"~/Box/lucy_king_files/MoD/APCA/figures/cesd_bai_adversity.png",
dpi = 1000,
height = 6,
width = 14.75
)
cor.test(df$ctq_total_W, df$cesd_total_W)
ctq_cesd<- correlationBF(df$ctq_total_W, df$cesd_total_W)
describe_posterior(ctq_cesd, ci = 0.95)$BF
SpearmanRho(df$prenatal_life_events_W, df$cesd_total_W, use = "complete.obs", conf.level = .95)
ple_cesd<- correlationBF(df$prenatal_life_events_W, df$cesd_total_W)
describe_posterior(ple_cesd, ci = 0.95)$BF
cor.test(df$ctq_total_W, df$bai_total_W)
ctq_bai<- correlationBF(df$ctq_total_W, df$bai_total_W)
describe_posterior(ctq_bai, ci = 0.95)$BF
SpearmanRho(df$prenatal_life_events_W, df$bai_total_W, use = "complete.obs", conf.level = .95)
ple_bai <- correlationBF(df$prenatal_life_events_W, df$bai_total_W)
describe_posterior(ple_bai, ci = 0.95)$BF
# maternal exposure
SpearmanRho(df$parent_num_types, df$total_problems_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$parent_num_childhood_W, df$total_problems_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$parent_num_precon, df$total_problems_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$preg_num_types_W, df$total_problems_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$since_child_num_types_W, df$total_problems_total_W, use = "complete.obs", conf.level = .95)
# child witnessing and exposure
SpearmanRho(df$child_num_wit_types_W, df$total_problems_total_W, use = "complete.obs", conf.level = .95)
SpearmanRho(df$child_num_dir_types_W, df$total_problems_total_W, use = "complete.obs", conf.level = .95)
cumulative_cbcl <- correlationBF(df$parent_num_types, df$total_problems_total_W)
describe_posterior(cumulative_cbcl, ci = 0.95)$BF
childhood_cbcl <- correlationBF(df$parent_num_childhood_W, df$total_problems_total_W)
childhood_cbcl <- describe_posterior(childhood_cbcl, ci = 0.95)$BF
precon_cbcl  <- correlationBF(df$parent_num_precon, df$total_problems_total_W)
precon_cbcl  <- describe_posterior(precon_cbcl, ci = 0.95)$BF
preg_cbcl  <- correlationBF(df$preg_num_types_W, df$total_problems_total_W)
preg_cbcl <- describe_posterior(preg_cbcl, ci = 0.95)$BF
since_cbcl  <- correlationBF(df$since_child_num_types_W, df$total_problems_total_W)
since_cbcl  <-describe_posterior(since_cbcl, ci = 0.95)$BF
wit_cbcl  <- correlationBF(df$child_num_wit_types_W, df$total_problems_total_W)
wit_cbcl  <-describe_posterior(wit_cbcl, ci = 0.95)$BF
dir_cbcl  <- correlationBF(df$child_num_dir_types_W, df$total_problems_total_W)
dir_cbcl  <-describe_posterior(dir_cbcl, ci = 0.95)$BF
cp_BFs <-
tibble(
key = c(
"parent_num_childhood",
"parent_num_precon",
"preg_num_types",
"since_child_num_types",
"child_num_wit_types",
"child_num_dir_types"
),
BF_cbcl= c(
childhood_cbcl,
precon_cbcl,
preg_cbcl,
since_cbcl,
wit_cbcl,
dir_cbcl
)
)
cp_BFs
lm.4 <- lm(
total_problems_total_W ~
scale(cesd_total, scale = FALSE) +
scale(bai_total, scale = FALSE),
data = df
)
lm.5 <- lm(
total_problems_total_W ~
scale(cesd_total, scale = FALSE) +
scale(bai_total, scale = FALSE) +
scale(parent_num_childhood_W, scale = FALSE) +
scale(parent_num_precon, scale = FALSE) +
scale(preg_num_types_W) +
scale(since_child_num_types_W),
data = df
)
lm.6 <- lm(
total_problems_total_W ~
scale(cesd_total, scale = FALSE) +
scale(bai_total, scale = FALSE) +
scale(child_num_dir_types_W) +
scale(child_num_wit_types_W),
data = df
)
check_model(lm.5)
check_model(lm.6)
lm.4_performance <- model_performance(lm.4)
lm.5_performance <- model_performance(lm.5)
lm.6_performance <- model_performance(lm.6)
# R-squared change for maternal adversity variables
lm.5_performance$R2_adjusted - lm.4_performance$R2
# R-squared change for child adversity variables
lm.6_performance$R2_adjusted - lm.4_performance$R2
model_parameters(lm.5)
model_parameters(lm.5, standardize = "refit")
model_parameters(lm.6)
model_parameters(lm.6, standardize = "refit")
scales_apca_cbcl <- list(
"Maternak childhood adversity" = scale_x_continuous(
breaks = seq.int(0, 14, 2)
),
"Preconception adversity" = scale_x_continuous(
breaks = seq.int(0, 10, 2)
),
"Prenatal adversity"= scale_x_continuous(
breaks = seq.int(0, 8, 1)
),
"Adversity since birth" = scale_x_continuous(
breaks = seq.int(0, 12, 2),
),
"Child direct adversity" = scale_x_continuous(
breaks = seq.int(0, 4, 1)
),
"Child witnessed adversity" = scale_x_continuous(
breaks = seq.int(0, 10, 1)
)
)
cp_BFs_lf <-
cp_BFs %>%
pivot_longer(
cols = -key
) %>%
rename(
adversity_type = key,
BF = value
)
df %>%
dplyr::select(
total_problems_total_W,
parent_num_childhood = parent_num_childhood_W,
parent_num_precon,
preg_num_types = preg_num_types_W,
since_child_num_types = since_child_num_types_W,
child_num_wit_types = child_num_wit_types_W,
child_num_dir_types = child_num_dir_types_W
) %>%
pivot_longer(
cols = parent_num_childhood:child_num_dir_types,
names_to = "adversity_type",
values_to = "adversity_score"
) %>%
left_join(cp_BFs_lf, by = c("adversity_type")) %>%
mutate(
adversity_type = factor(
adversity_type,
levels = c(
"parent_num_childhood",
"parent_num_precon",
"preg_num_types",
"since_child_num_types",
"child_num_wit_types",
"child_num_dir_types"
),
labels = c(
"Maternal childhood adversity",
"Preconception adversity",
"Prenatal adversity",
"Adversity since birth",
"Child witnessed adversity",
"Child direct adversity"
)
),
BF_logic = case_when(
BF > .33 & BF < 1 ~ "Anecdotal",
BF >= 1 & BF < 3 ~ "Anecdotal",
BF >= 3 & BF < 10 ~ "Moderate",
BF >= 10 & BF < 30 ~ "Strong",
BF >= 30 & BF < 100 ~ "Very strong",
BF >= 100 ~ "Extreme"
),
BF_logic = factor(
BF_logic,
levels = c("Anecdotal", "Moderate", "Strong", "Very strong", "Extreme")
)
) %>%
ggplot(aes(adversity_score, total_problems_total_W)) +
geom_jitter2(size = 4, alpha = 1/2, color = "black") +
geom_smooth(
method = "lm",
size = 4,
se = FALSE,
aes(color = BF_logic)
) +
scale_y_continuous(breaks = seq.int(0, 80, 10)) +
scale_x_continuous(breaks = seq.int(0, 14, 2)) +
scale_color_manual(
values = c(
"#ffffb2",
"#fed976",
"#feb24c",
"#fd8d3c",
"#f03b20",
"#bd0026"
),
drop = FALSE
) +
theme_grey() +
theme(
panel.grid = element_blank(),
plot.title = element_text(size = 18, hjust = .5, face = "bold"),
axis.title = element_text(size = 20),
axis.text = element_text(size = 18),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
strip.text.x = element_text(size = 16, face = "bold", color = "black"),
strip.text.y = element_text(size = 20, face = "bold", color = "black"),
strip.background = element_blank(),
legend.position = "right"
) +
labs(
color = "Bayes Factor\n(Strength of evidence)",
x = NULL,
y = "Child total behavioral and emotional problems"
) +
facet_wrap(
.~ adversity_type,
scales = "free"
)
ggsave(
"~/Box/lucy_king_files/MoD/APCA/figures/cbcl_adversity.png",
dpi = 1000,
height = 7,
width = 13
)
ggsave(
"~/Box/lucy_king_files/MoD/APCA/figures/cbcl_adversity.png",
dpi = 1000,
height = 7,
width = 13
)
ggsave(
"~/Box/lucy_king_files/MoD/APCA/figures/cbcl_adversity.png",
dpi = 1000,
height = 8,
width = 14
)
